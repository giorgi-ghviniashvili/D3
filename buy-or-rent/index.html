<!DOCTYPE html>

<html>

<head>
    <meta charset="UTF-8">
    <title>Chart</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">
     <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style type="text/css">
        .domain {
            stroke: #fff;
          }

        svg {
          display: block;
          margin: auto;
        }

        .container {
          margin-bottom: 30px;
        }

        .ticks {
          font: 10px sans-serif;
        }

        .track,
        .track-inset,
        .track-overlay {
          stroke-linecap: round;
        }

        .track {
          stroke: #000;
          stroke-opacity: 0.3;
          stroke-width: 10px;
        }

        .track-inset {
          stroke: #ddd;
          stroke-width: 8px;
        }

        .track-overlay {
          pointer-events: stroke;
          /*stroke-width: 50px;*/
          stroke: transparent;
          
        }

        .handle {
          fill: #fff;
          stroke: #000;
          stroke-opacity: 0.5;
          stroke-width: 1.25px;
          cursor: ew-resize;
        }
        .result{
            background-color: rgb(186, 216, 10);
            border-radius: 5px;
            padding: 10px;
            text-align: center;
        }
        .axis text {
          fill: #89919e;
          font-weight: bold;
          font-size: 11px;
        }
        .axis line {
          stroke: #89919e;
          stroke-width: 1.5px; 
        }
        .indicator-container{
          align-items: flex-end;
        }
        .inputDiv input {
          margin-bottom: 2px !important;
        }
        .inputDiv p {
          margin: 0px;
        }
        .icon{
          float: right;
          margin-top: 2px;
          color: rgba(0, 0, 0, 0.54);
        }
    </style>
</head>

<body translate="no">
    <main>
  <div class="container">
    <div class="row">
      <div class="col s12 m8 l9">
        
        <div class="divider"></div>
        <div class="section">
          <h5>Home Price</h5>
          <p>lorem ipsum lorem ipsum</p>
          <div class="indicator-container valign-wrapper">
            <div class="inputDiv col s2 inputDivHomePrice">
              <div class="col s10">
                <input>
              </div>
              <span>
                <i class="material-icons">help</i>
              </span>
                <div>
                  <input type="text" class="validate" >
                  <i class="tiny material-icons icon">cancel</i>
                </div>
                
                <p>Home Price <i class="tiny material-icons icon">help</i></p>
            </div>
            <div id="home-price" class="chart-container col s10">
            </div>
          </div>
        </div>
        <div class="divider"></div>
        <div class="section">
          <h5>How Long Do You Plan to Stay?</h5>
          <div class="indicator-container valign-wrapper">
            <div class="inputDiv col s2">
              <input>
              <p>lorem ipsum <i class="tiny material-icons icon">help</i></p>
            </div>
            <div id="how-long" class="chart-container col s10">
            </div>
          </div>
        </div>
        <div class="divider"></div>
        <div class="section">
          <h5>What Are Your Mortgage Details?</h5>
          <div class="indicator-container valign-wrapper">
            <div class="inputDiv col s2">
              <input type="text" class="validate">
              <p>Mortgage rate <i class="tiny material-icons icon">help</i></p>
            </div>
            <div id="mortgage-rate" class="chart-container col s10">
            </div>
          </div>
          
          <div class="indicator-container valign-wrapper">
            
            <div class="inputDiv col s2">
              <input type="text" class="validate">
              <p>Down payment <i class="tiny material-icons icon">help</i></p>
            </div>
            <div id="down-rate" class="chart-container col s10">
            </div>
          </div>
          
           <div class="indicator-container valign-wrapper">
            
            <div class="inputDiv col s2">
              <input type="text" class="validate">
              <p>Length <i class="tiny material-icons icon">help</i></p>
            </div>
            <div id="mortgage-period" class="chart-container col s10">
            </div>
          </div>
        </div>
        <div class="section">
          <h5>What Does the Future Hold?</h5>
          <div class="indicator-container valign-wrapper">
            
            <div class="inputDiv col s2">
              <input>
              <p>Home growth <i class="tiny material-icons icon">help</i></p>
            </div>
            <div id="home-price-growth-rate" class="chart-container col s10">
            </div>
          </div>

          <div class="indicator-container valign-wrapper">
            <div class="inputDiv col s2">
              <input>
              <p>Rent growth <i class="tiny material-icons icon">help</i></p>
          </div>
            <div id="rent-growth-rate" class="chart-container col s10">
            </div>
          </div>

          <div class="indicator-container valign-wrapper">
            <div class="inputDiv col s2">
              <input>
              <p>Invest rate <i class="tiny material-icons icon">help</i></p>
          </div>
            <div id="investment-return-rate" class="chart-container col s10">
            </div>
          </div>

          <div class="indicator-container valign-wrapper">
            <div class="inputDiv col s2">
              <input>
              <p>Inflation rate <i class="tiny material-icons icon">help</i></p>
          </div>
            <div id="inflation-rate" class="chart-container col s10">
            </div>
          </div>
        </div>
        <div class="section">
          <h5>Taxes</h5>
          <p>Property taxes and mortgage-interest costs are significant but also deductible. The higher your marginal tax rate is, the bigger the deduction.</p>
          <div class="indicator-container valign-wrapper">
            <div class="inputDiv col s2">
              <input>
              <p>Property tax rate <i class="tiny material-icons icon">help</i></p>
            </div>
            <div id="property-tax-rate" class="chart-container col s10">
            </div>
          </div>
          <div class="indicator-container valign-wrapper">
            <div class="inputDiv col s2">
              <input>
              <p>marginal tax rate <i class="tiny material-icons icon">help</i></p>
            </div>
            <div id="marginal-tax-rate" class="chart-container col s10">
            </div>
          </div>
        </div>
        <div class="section">
          <h5>Closing Costs</h5>
          <p>Youâ€™ll have to pay various fees when you buy your home, as well as when you sell it.</p>
          <div class="indicator-container valign-wrapper">
            <div class="inputDiv col s2">
              <input>
              <p>Buying cost <i class="tiny material-icons icon">help</i></p>
            </div>
            <div id="costs-of-buying-home" class="chart-container col s10">
            </div>
          </div>
          <div class="indicator-container valign-wrapper">
            <div class="inputDiv col s2">
              <input>
              <p>Selling cost <i class="tiny material-icons icon">help</i></p>
            </div>
            <div id="costs-of-selling-home" class="chart-container col s10">
            </div>
          </div>
        </div>
        <div class="section">
          <h5>Maintenance and Fees</h5>
          <p>Owning a home comes with a surprising variety of expenses that renters do not directly pay.</p>
          <div class="indicator-container valign-wrapper">
            <div class="inputDiv col s2">
              <input>
              <p>maintainance/renovation <i class="tiny material-icons icon">help</i></p>
            </div>
            <div id="maintainance-renovation" class="chart-container col s10">
            </div>
          </div>
          <div class="indicator-container valign-wrapper">
            <div class="inputDiv col s2">
              <input>
              <p>Homeowner's insurance <i class="tiny material-icons icon">help</i></p>
            </div>
            <div id="insurance" class="chart-container col s10">
            </div>
          </div>
          <div class="indicator-container valign-wrapper">
            <div class="inputDiv col s2">
              <input>
              <p>Mothly utilities <i class="tiny material-icons icon">help</i></p>
            </div>
            <div id="mothly-utilities" class="chart-container col s10">
            </div>
          </div>
          <div class="indicator-container valign-wrapper">
            <div class="inputDiv col s2">
              <input>
              <p>Mothly common fees <i class="tiny material-icons icon">help</i></p>
            </div>
            <div id="mothly-common-fees" class="chart-container col s10">
            </div>
          </div>
          <div class="indicator-container valign-wrapper">
            <div class="inputDiv col s2">
              <input>
              <p>Common fees deduction <i class="tiny material-icons icon">help</i></p>
            </div>
            <div id="common-fees-deduction" class="chart-container col s10">
            </div>
          </div>
        </div>
        <div class="section">
          <h5>Additional Renting Costs</h5>
          <p>These are the costs on top of rent, such as the fee you pay to a broker and the opportunity cost on your security deposit. But these expenses typically have a negligible impact.</p>
          <div class="indicator-container valign-wrapper">
            <div class="inputDiv col s2">
              <input>
              <p>Security deposit <i class="tiny material-icons icon">help</i></p>
            </div>
            <div id="security-deposit" class="chart-container col s10">
            </div>
          </div>
          <div class="indicator-container valign-wrapper">
            <div class="inputDiv col s2">
              <input>
              <p>Broker's fee <i class="tiny material-icons icon">help</i></p>
            </div>
            <div id="brokers-fee" class="chart-container col s10">
            </div>
          </div>
          <div class="indicator-container valign-wrapper">
            <div class="inputDiv col s2">
              <input>
              <p>Rent's insurance <i class="tiny material-icons icon">help</i></p>
            </div>
            <div id="rents-insurance" class="chart-container col s10">
            </div>
          </div>
        </div>
      </div>
      <div class="col hide-on-small-only m4 l3">
        <div class="toc-wrapper pinned" style="top: 30px;">

          <div>
            If you can rent a similar home with less then ...
          </div>
          <div id="result" class="result"></div>
          <div> ... Then renting is better</div>
        </div>
      </div>
    </div>
  </div>
</main>
    <script src="libs/d3.v4.min.js"></script>
    <script src="scripts/constants.js"></script>
    <script src="scripts/logic.js"></script>
    <script src="scripts/d3script.js"></script>
    <script>
    var chartWidth = document.getElementsByClassName("chart-container")[0].clientWidth;
    var homePriceChartHeight = 300;
    var otherChartHeight = 180;
    function getData() {
          var startNumber = 30000;
          var endNumber = 3000000;
          var numberOfBars = 50;
          var data = [startNumber];
          var difference = 1000;
          var i = 0;

          while(true){
              var number = data[i] + difference;
              if (number >= endNumber)
                    break;
              data.push(number);
              difference *= 1.1;
              i++;
          }
          return data;
    }

    var chartsData = [
      // home price
      { 
        name: "home-price",
        container: "#home-price",
        indicator: "homePrice",
        width: chartWidth, 
        height: homePriceChartHeight,
        xScaleExtern: d3.scalePow()
                        .exponent(0.2)
                        .domain([30000, 3000000]),
        data: getData(),
        dragCallback: function(value) {
          currentIndicators.homePrice = value;

          var p = getPayment(currentIndicators.homePrice, currentIndicators.mortgageYears, 
              currentIndicators.mortgageRate, currentIndicators.downRate);

          currentPayment = p;

          charts.forEach(chart => {
            chart.updateChart(value);
          });

          var result = document.getElementById("result");

          result.innerText = "$ " + Math.round(p) + " per month";
        }
      },
      // living period
      { 
        name: "living-period",
        container: "#how-long",
        indicator: "livingLength",
        width: chartWidth, 
        height: otherChartHeight,
        xAxisFormat: d3.format(""),
        xScaleExtern: d3.scaleLinear()
                        .domain([1, 40]),
        data: d3.range(1, 40, 1),
        dragCallback: function(value){

            
        }
      },
      // mortgage rate
      { 
        name: "mortgage-rate",
        container: "#mortgage-rate",
        indicator: "mortgageRate",
        width: chartWidth, 
        height: otherChartHeight,
        xScaleExtern: d3.scaleLinear()
                        .domain([0, 15]),
        xAxisFormat: d3.format(""),
        data: d3.range(0, 15, 0.3),
        dragCallback: function(value){

            currentIndicators.mortgageRate = value;

            var p = getPayment(currentIndicators.homePrice, currentIndicators.mortgageYears, value, currentIndicators.downRate);

            currentPayment = p;

            charts.forEach(chart => {
              chart.updateChart(currentIndicators.homePrice);
            });

            var result = document.getElementById("result");

            result.innerText = "$ " + Math.round(p) + " per month";


        }
      },
      // down-rate
      { 
        name: "down-rate",
        container: "#down-rate",
        indicator: "downRate",
        width: chartWidth, 
        height: otherChartHeight,
        xScaleExtern: d3.scaleLinear()
                        .domain([0, 100]),
        data: d3.range(0, 100, 3),
        xAxisFormat: d3.format(""),
        dragCallback: function(value){

            currentIndicators.downRate = value;

            var p = getPayment(currentIndicators.homePrice, currentIndicators.mortgageYears, currentIndicators.mortgageRate, value);

            currentPayment = p;

            charts.forEach(chart => {
              chart.updateChart(currentIndicators.homePrice);
            });

            var result = document.getElementById("result");

            result.innerText = "$ " + Math.round(p) + " per month";


        }
      },
      // mortgage period
      { 
        name: "mortgage-period",
        container: "#mortgage-period",
        indicator: "mortgageYears",
        width: chartWidth, 
        height: otherChartHeight,
        xScaleExtern: d3.scaleLinear()
                        .domain([0, 40]),
        data: d3.range(1, 41),
        xAxisFormat: d3.format(""),
        dragCallback: function(value){

            currentIndicators.mortgageYears = value;

            var p = getPayment(currentIndicators.homePrice, value, currentIndicators.mortgageRate, currentIndicators.downRate);

            currentPayment = p;

            charts.forEach(chart => {
              chart.updateChart(currentIndicators.homePrice);
            });

            var result = document.getElementById("result");

            result.innerText = "$ " + Math.round(p) + " per month";


        }
      },
      // home price growth rate
      { 
        name: "home-price-growth-rate",
        container: "#home-price-growth-rate",
        indicator: "annualAppreciation",
        width: chartWidth, 
        height: otherChartHeight,
        xScaleExtern: d3.scaleLinear()
                        .domain([-5, 15]),
        data: d3.range(-5, 15, 1),
        xAxisFormat: d3.format(""),
        dragCallback: function(value){

        }
      },
      // rent growth rate
      { 
        name: "rent-growth-rate",
        container: "#rent-growth-rate",
        indicator: "",
        width: chartWidth, 
        height: otherChartHeight,
        xScaleExtern: d3.scaleLinear()
                        .domain([-5, 15]),
        data: d3.range(-5, 15, 1),
        xAxisFormat: d3.format(""),
        dragCallback: function(value){

        }
      },
      // Investment return rate
      { 
        name: "investment-return-rate",
        container: "#investment-return-rate",
        indicator: "",
        width: chartWidth, 
        height: otherChartHeight,
        xScaleExtern: d3.scaleLinear()
                        .domain([1, 40]),
        data: d3.range(1, 41),
        xAxisFormat: d3.format(""),
        dragCallback: function(value){

        }
      },
      // inflation rate
      { 
        name: "inflation-rate",
        container: "#inflation-rate",
        indicator: "",
        width: chartWidth, 
        height: otherChartHeight,
        xScaleExtern: d3.scaleLinear()
                        .domain([1, 40]),
        data: d3.range(1, 40),
        xAxisFormat: d3.format(""),
        dragCallback: function(value){

        }
      },
      // property tax
      { 
        name: "rent-growth-rate",
        container: "#property-tax-rate",
        indicator: "propertyTaxRate",
        width: chartWidth, 
        height: otherChartHeight,
        xScaleExtern: d3.scaleLinear()
                        .domain([0, 10]),
        data: d3.range(0, 10, 1),
        xAxisFormat: d3.format(""),
        dragCallback: function(value){

        }
      },
      // pmarginal tax
      { 
        name: "rmarginal-tax-rate",
        container: "#marginal-tax-rate",
        indicator: "marginalIncomeTaxRate",
        width: chartWidth, 
        height: otherChartHeight,
        xScaleExtern: d3.scaleLinear()
                        .domain([0, 50]),
        data: d3.range(0, 50, 1),
        xAxisFormat: d3.format(""),
        dragCallback: function(value){

        }
      },
      // costs of buying home
      { 
        name: "costs-of-buying-home",
        container: "#costs-of-buying-home",
        indicator: "",
        width: chartWidth, 
        height: otherChartHeight,
        xScaleExtern: d3.scaleLinear()
                        .domain([0, 50]),
        data: d3.range(0, 50, 1),
        xAxisFormat: d3.format(""),
        dragCallback: function(value){

        }
      },
      // costs-of selling
      { 
        name: "costs-of-selling-home",
        container: "#costs-of-selling-home",
        indicator: "",
        width: chartWidth, 
        height: otherChartHeight,
        xScaleExtern: d3.scaleLinear()
                        .domain([0, 50]),
        data: d3.range(0, 50, 1),
        xAxisFormat: d3.format(""),
        dragCallback: function(value){

        }
      },
      // costs-of selling
      { 
        name: "maintainance-renovation",
        container: "#maintainance-renovation",
        indicator: "",
        width: chartWidth, 
        height: otherChartHeight,
        xScaleExtern: d3.scaleLinear()
                        .domain([0, 50]),
        data: d3.range(0, 50, 1),
        xAxisFormat: d3.format(""),
        dragCallback: function(value){

        }
      },
      // costs-of selling
      { 
        name: "insurance",
        container: "#insurance",
        indicator: "insurance",
        width: chartWidth, 
        height: otherChartHeight,
        xScaleExtern: d3.scaleLinear()
                        .domain([0, 50]),
        data: d3.range(0, 50, 1),
        xAxisFormat: d3.format(""),
        dragCallback: function(value){

        }
      },
      // costs-of selling
      { 
        name: "mothly-utilities",
        container: "#mothly-utilities",
        indicator: "",
        width: chartWidth, 
        height: otherChartHeight,
        xScaleExtern: d3.scaleLinear()
                        .domain([0, 50]),
        data: d3.range(0, 50, 1),
        xAxisFormat: d3.format(""),
        dragCallback: function(value){

        }
      },
      // costs-of selling
      { 
        name: "mothly-common-fees",
        container: "#mothly-common-fees",
        indicator: "",
        width: chartWidth, 
        height: otherChartHeight,
        xScaleExtern: d3.scaleLinear()
                        .domain([0, 50]),
        data: d3.range(0, 50, 1),
        xAxisFormat: d3.format(""),
        dragCallback: function(value){

        }
      },
      // costs-of selling
      { 
        name: "common-fees-deduction",
        container: "#common-fees-deduction",
        indicator: "",
        width: chartWidth, 
        height: otherChartHeight,
        xScaleExtern: d3.scaleLinear()
                        .domain([0, 50]),
        data: d3.range(0, 50, 1),
        xAxisFormat: d3.format(""),
        dragCallback: function(value){

        }
      },
      // costs-of selling
      { 
        name: "security-deposit",
        container: "#security-deposit",
        indicator: "",
        width: chartWidth, 
        height: otherChartHeight,
        xScaleExtern: d3.scaleLinear()
                        .domain([0, 50]),
        data: d3.range(0, 50, 1),
        xAxisFormat: d3.format(""),
        dragCallback: function(value){

        }
      },
      // costs-of selling
      { 
        name: "brokers-fee",
        container: "#brokers-fee",
        indicator: "",
        width: chartWidth, 
        height: otherChartHeight,
        xScaleExtern: d3.scaleLinear()
                        .domain([0, 50]),
        data: d3.range(0, 50, 1),
        xAxisFormat: d3.format(""),
        dragCallback: function(value){

        }
      },
      // costs-of selling
      { 
        name: "rents-insurance",
        container: "#rents-insurance",
        indicator: "",
        width: chartWidth, 
        height: otherChartHeight,
        xScaleExtern: d3.scaleLinear()
                        .domain([0, 50]),
        data: d3.range(0, 50, 1),
        xAxisFormat: d3.format(""),
        dragCallback: function(value){

        }
      }
    ];

    var charts = [];

    chartsData.forEach(chartObj => {

      var chart = 
            renderChart()
            .chartName(chartObj.name)
            .svgHeight(chartObj.height)
            .svgWidth(chartObj.width)
            .marginBottom(30)
            .marginRight(50)
            .container(chartObj.container)
            .data(chartObj.data)
            .xScaleExtern(chartObj.xScaleExtern)
            .indicator(chartObj.indicator)
            .onDrag(chartObj.dragCallback)
            ;

      if (chartObj.xAxisFormat){
        chart.xAxisFormat(chartObj.xAxisFormat);
      }

      chart.debug(true)
            .run();

      charts.push(chart);

    });
    </script>
</body>
</html>